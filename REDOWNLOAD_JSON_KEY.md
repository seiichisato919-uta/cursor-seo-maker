# JSONキーファイルを再ダウンロードする方法

## 重要：既存のキーがある場合

既にキーが作成されている場合は、**同じキーを再ダウンロードすることはできません**。
新しいキーを作成する必要があります。

## 方法1: 既存のサービスアカウントに新しいキーを追加する（推奨）

### ステップ1: Google Cloud Consoleにアクセス

1. [Google Cloud Console](https://console.cloud.google.com/) にアクセス
2. プロジェクトを選択

### ステップ2: サービスアカウントのページを開く

1. 左側のメニューから「IAMと管理」→「サービスアカウント」を選択
   - または「APIとサービス」→「認証情報」→「サービスアカウント」タブを選択

### ステップ3: サービスアカウントを選択

1. 作成したサービスアカウントの名前をクリック
   - 例：`seo-article-creator@プロジェクト名.iam.gserviceaccount.com`

### ステップ4: 新しいキーを作成

1. 上部のタブから「キー」を選択
2. 「キーを追加」ボタンをクリック
3. 「新しいキーを作成」を選択
4. キーのタイプで「JSON」を選択
5. 「作成」をクリック
6. **JSONファイルが自動的にダウンロードされます**

### ステップ5: 古いキーを削除（オプション）

既存のキーが表示されている場合：
1. 古いキー（使用していないもの）の右側にある「削除」アイコンをクリック
2. 確認ダイアログで「削除」をクリック

**注意**: 削除したキーは復元できません。確実に新しいキーが動作することを確認してから削除してください。

## 方法2: 新しいサービスアカウントを作成する

既存のサービスアカウントを使いたくない場合は、新しいサービスアカウントを作成できます。

### ステップ1: 新しいサービスアカウントを作成

1. Google Cloud Consoleで「IAMと管理」→「サービスアカウント」を選択
2. 「+ サービスアカウントを作成」をクリック
3. サービスアカウント名を入力（例：`seo-article-creator-2`）
4. 「作成して続行」をクリック
5. 「完了」をクリック

### ステップ2: JSONキーをダウンロード

1. 作成したサービスアカウントをクリック
2. 「キー」タブを選択
3. 「キーを追加」→「新しいキーを作成」
4. 「JSON」を選択して「作成」
5. JSONファイルがダウンロードされます

### ステップ3: スプレッドシートを共有

新しいサービスアカウントの `client_email` でスプレッドシートを共有してください。

## ダウンロードしたJSONファイルの確認

ダウンロードしたJSONファイルには以下の情報が含まれています：

- `type`: "service_account"
- `project_id`: プロジェクトID
- `private_key`: 秘密鍵
- `client_email`: サービスアカウントのメールアドレス（重要！）
- その他の認証情報

## 次のステップ

1. ダウンロードしたJSONファイルの内容を `.env.local` に設定
2. スプレッドシートを新しい `client_email` で共有
3. 動作確認

## トラブルシューティング

### Q: 「キーを追加」ボタンが見つからない
A: サービスアカウントの詳細ページで「キー」タブを選択しているか確認してください。

### Q: 複数のキーが表示される
A: 複数のキーを作成できますが、通常は最新のキー1つだけを使用します。古いキーは削除しても問題ありません。

### Q: キーを削除しても大丈夫？
A: そのキーを使用しているアプリケーションが動作しなくなります。新しいキーが正常に動作することを確認してから削除してください。


